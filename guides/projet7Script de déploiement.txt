1ï¸âƒ£ Un script de dÃ©ploiement automatique (bash)

2ï¸âƒ£ Une procÃ©dure de dÃ©ploiement claire (document prÃªte Ã  Ãªtre prÃ©sentÃ©e)


âœ… 1) Script de dÃ©ploiement (deploy.sh)

Ã€ placer Ã  la racine du projet (projet7/)
Puis rendre exÃ©cutable :
chmod +x deploy.sh
------------------------------
#!/bin/bash

echo "ğŸš€ DÃ©ploiement en cours..."

# 1. Mettre Ã  jour le dÃ©pÃ´t
echo "ğŸ“¦ Mise Ã  jour du code source..."
git pull origin main

# 2. Installer les dÃ©pendances
echo "ğŸ”§ Installation des dÃ©pendances..."
npm install

# 3. Compilation (si front ou build â€“ sinon ignorÃ©)
# echo "ğŸ—ï¸ Build du projet..."
# npm run build

# 4. RedÃ©marrage du service avec PM2
echo "â™»ï¸ RedÃ©marrage du serveur..."
pm2 restart wave-api || pm2 start server.js --name "wave-api"

# 5. Affichage de lâ€™Ã©tat
pm2 status

echo "âœ… DÃ©ploiement terminÃ© avec succÃ¨s."


-----------------------------------------
Donner les permissions :
chmod +x deploy.sh
Lancer le dÃ©ploiement :
./deploy.sh

ğŸ“„ 2ï¸âƒ£ ProcÃ©dure de dÃ©ploiement (document)
Titre : ProcÃ©dure de DÃ©ploiement de lâ€™API Wave

ğŸ¯ Objectif

DÃ©ployer lâ€™application Wave API (Node.js + Express + MongoDB) sur un serveur de production Linux.

ğŸ—ï¸ PrÃ©-requis
Outil	UtilitÃ©
Node.js (â‰¥ 18)	ExÃ©cution du serveur
npm	Gestion des packages
MongoDB Atlas ou local	Base de donnÃ©es
Git	RÃ©cupÃ©ration du projet
PM2	Gestion du processus Node.js
NGINX (optionnel)	Reverse proxy et HTTPS

1) RÃ©cupÃ©ration du projet sur le serveur
git clone https://github.com/mon-repo/projet6.git
cd projet6

2) Configuration des variables dâ€™environnement

CrÃ©er un fichier .env Ã  la racine :
MONGO_URI=mongodb+srv://user:password@cluster.mongodb.net/wave
JWT_SECRET=une_phrase_complexe
TOKEN_EXP=24h
PORT=3000

3) Installation des dÃ©pendances
npm install

4) Installation et configuration de PM2

Installer PM2 :
npm install -g pm2

Lancer lâ€™application une premiÃ¨re fois :
pm2 start server.js --name "wave-api"

Sauvegarder la configuration + redÃ©marrage auto mÃªme aprÃ¨s reboot :
pm2 save
pm2 startup

5) âš™ï¸ (Optionnel mais recommandÃ©) Configuration NGINX en reverse proxy
Fichier : /etc/nginx/sites-available/wave
server {
  listen 80;
  server_name mon-domaine.fr;

  location / {
    proxy_pass http://localhost:3000;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
  }
}
Activer la configuration :
ln -s /etc/nginx/sites-available/wave /etc/nginx/sites-enabled/
systemctl reload nginx

6) DÃ©ploiement rapide aprÃ¨s mise Ã  jour du code
./deploy.sh

ou si premiÃ¨re fois :
pm2 restart wave-api

7) VÃ©rification du bon fonctionnement
pm2 logs wave-api
pm2 status
curl http://localhost:3000/api/books
âœ… RÃ©sultat final

DÃ©ploiement automatisÃ©

Serveur sÃ©curisÃ© et stable avec PM2

Base MongoDB fonctionnelle

Reverse proxy opÃ©rationnel (facultatif)